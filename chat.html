<!DOCTYPE html>
<html>
<head>
    <title>MercX Chat</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        body{background:#111;color:#fff;font-family:Arial;margin:0;height:100vh;display:flex;flex-direction:column;}
        #messages{flex:1;overflow-y:auto;padding:20px;}
        .msg{margin:10px 0;padding:15px;border-radius:20px;max-width:80%;}
        .me{background:#00ff88;color:#000;margin-left:auto;border-bottom-right-radius:0;}
        .other{background:#333;margin-right:auto;border-bottom-left-radius:0;}
        .input{background:#222;padding:10px;display:flex;}
        input{flex:1;padding:15px;border-radius:50px;background:#333;color:#fff;border:none;}
        button{background:#00ff88;padding:15px;border:none;border-radius:50%;margin-left:10px;}
    </style>
</head>
<body>
    <h2 style="text-align:center;background:#075e54;padding:15px;margin:0;color:#fff;">MercX - {{ phone }}</h2>
    <div id="messages"></div>
    <div class="input">
        <input type="text" id="msg" placeholder="Type message...">
        <button onclick="send()">Send</button>
    </div>

    <script>
        const socket = io();
        socket.emit('join');
        function send(){
            const input = document.getElementById('msg');
            if(input.value.trim()){
                socket.emit('send', {msg: input.value});
                input.value = '';
            }
        }
        document.getElementById('msg').addEventListener('keypress', e=> {if(e.key==='Enter')send()});
        socket.on('message', d=> {
            const div = document.createElement('div');
            div.className = d.phone === "{{ phone }}" ? 'msg me' : 'msg other';
            div.innerHTML = `<strong>${d.phone}:</strong> ${d.msg}`;
            document.getElementById('messages').appendChild(div);
            div.scrollIntoView();
        });
    </script>
</body>
</html>